"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[706],{706:function(e,t,a){a.r(t),a.d(t,{default:function(){return ea}});var s=a(4246),l=a(4935),n=a(5783),i=a(6805),r=a(989);let c={auth:{clientId:"68357b1a-48ee-462c-9bb4-3a7e6a008ef6",authority:"https://login.microsoftonline.com/c1f3dc23-b7f8-48d3-9b5d-2b12f158f01f",redirectUri:window.location.origin,postLogoutRedirectUri:window.location.origin,navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{allowNativeBroker:!1,loggerOptions:{loggerCallback:(e,t,a)=>{if(!a)switch(e){case"Error":console.error(t);return;case"Info":console.info(t);return;case"Verbose":console.debug(t);return;case"Warning":console.warn(t);return;default:return}}}}},o=new r.Lx(c),d={scopes:["User.Read"],prompt:"select_account"},m=(0,i.Ue)((e,t)=>({user:null,isAuthenticated:!1,isLoading:!0,error:null,accessToken:null,async initialize(){try{await o.initialize();let a=o.getAllAccounts();if(a.length>0){let s=a[0];o.setActiveAccount(s);try{let e=await o.acquireTokenSilent({...d,account:s});await t().verifyWithBackend(e.accessToken)}catch(t){console.log("Silent token acquisition failed, user needs to login again"),e({isLoading:!1})}}else e({isLoading:!1})}catch(t){console.error("MSAL initialization failed:",t),e({error:"Failed to initialize authentication",isLoading:!1})}},async login(){e({isLoading:!0,error:null});try{let e=await o.loginPopup(d);e&&(o.setActiveAccount(e.account),await t().verifyWithBackend(e.accessToken))}catch(t){console.error("Login failed:",t),e({error:"Failed to login with Microsoft. Please try again.",isLoading:!1})}},async logout(){try{o.getActiveAccount()&&o.setActiveAccount(null),e({user:null,isAuthenticated:!1,accessToken:null,error:null,isLoading:!1})}catch(t){console.error("Logout failed:",t),e({user:null,isAuthenticated:!1,accessToken:null,error:null,isLoading:!1})}},async getAccessToken(){try{let t=o.getActiveAccount();if(!t)throw Error("No active account");let a=await o.acquireTokenSilent({...d,account:t});return e({accessToken:a.accessToken}),a.accessToken}catch(t){console.error("Token acquisition failed:",t);try{let t=await o.acquireTokenPopup(d);return e({accessToken:t.accessToken}),t.accessToken}catch(e){throw console.error("Interactive token acquisition failed:",e),e}}},async verifyWithBackend(t){try{let a=await fetch("http://localhost:3001/api/auth/microsoft",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:t})});if(!a.ok)throw Error("Backend verification failed");let s=await a.json();e({user:s.user,accessToken:t,isAuthenticated:!0,isLoading:!1,error:null})}catch(t){throw console.error("Backend verification failed:",t),e({error:"Failed to verify user with backend",isLoading:!1,isAuthenticated:!1}),t}},clearError(){e({error:null})}}));m.getState().initialize();var u=a(5827),x=a(570),h=a(9836),p=a(6167),b=a(4178),f=a(3703),j=a(7378);async function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=await m.getState().getAccessToken(),s=await fetch("".concat("http://localhost:3001/api").concat(e),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a),...t.headers},...t});if(!s.ok){if(401===s.status)throw m.getState().logout(),Error("Authentication required");throw Error("API Error: ".concat(s.status," ").concat(s.statusText))}return await s.json()}catch(e){if(console.error("API request failed:",e),"Authentication required"===e.message)throw e;throw Error("Persistence unavailable")}}async function y(){return await g("/habits")}async function v(e){return e.id?await g("/habits/".concat(e.id),{method:"PUT",body:JSON.stringify(e)}):await g("/habits",{method:"POST",body:JSON.stringify(e)})}async function N(e){await g("/habits/".concat(e),{method:"DELETE"})}async function w(){return await g("/completions")}async function k(e){return await g("/completions?habitId=".concat(e))}async function C(e,t){return await g("/completions",{method:"POST",body:JSON.stringify({habitId:e,timestamp:t})})}async function T(e){await g("/completions/".concat(e),{method:"DELETE"})}var D=a(5763),S=a(6503);function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();return Math.max((0,u.b)(new Date(t)).getTime(),(0,u.b)(new Date(e.startDate?e.startDate:e.createdAt)).getTime())}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),a=new Date(t);if("daily"===e.periodType)return{start:(0,u.b)(a).getTime(),end:(0,x.E)((0,u.b)(a),1).getTime()};if("monthly"===e.periodType)return{start:(0,p.N)(a).getTime(),end:(0,h.z)((0,p.N)(a),1).getTime()};let s=(0,u.b)(new Date(M(e,t))),l=Math.floor(Math.max(0,(0,D.w)(a,s))/7);return{start:(0,x.E)(s,7*l).getTime(),end:(0,x.E)(s,(l+1)*7).getTime()}}function A(e,t){let a=(0,u.b)(new Date(M(e))),s=new Date(t);return"daily"===e.periodType?(0,D.w)((0,u.b)(s),a):"monthly"===e.periodType?(0,S.T)((0,p.N)(s),(0,p.N)(a)):Math.floor((0,D.w)((0,u.b)(s),a)/7)}function q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();return A(e,t)}let L=(0,i.Ue)((e,t)=>({habits:[],completions:[],persistenceError:null,async rehydrate(){try{let t=await y(),a=await w();e({habits:t,completions:a,persistenceError:null})}catch(t){e({persistenceError:"Data storage is unavailable. Changes will not persist."})}},async createHabit(t){try{let a=await v(t);return e(e=>({habits:[...e.habits,a],persistenceError:null})),a}catch(t){return e({persistenceError:"Failed to save habit."}),null}},async updateHabit(a,s){try{let l=t().habits.find(e=>e.id===a);if(!l)return null;let n=await v({...l,...s});return e(e=>({habits:e.habits.map(e=>e.id===a?n:e),persistenceError:null})),n}catch(t){return e({persistenceError:"Failed to update habit."}),null}},async deleteHabit(t){try{await N(t),e(e=>({habits:e.habits.filter(e=>e.id!==t),completions:e.completions.filter(e=>e.habitId!==t),persistenceError:null}))}catch(t){e({persistenceError:"Failed to delete habit."})}},async addCompletion(a){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),l=t().habits.find(e=>e.id===a);if(!l||!function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),{start:s,end:l}=E(e,a);return t>=s&&t<l}(l,s))return null;let{start:n,end:i}=E(l);if(t().completions.filter(e=>e.habitId===a&&e.timestamp>=n&&e.timestamp<i).length>=l.frequency)return null;try{let t=await C(a,s);return e(e=>({completions:[...e.completions,t],persistenceError:null})),t}catch(t){return e({persistenceError:"Failed to add completion."}),null}},async undoLastCompletion(a){let s=t().habits.find(e=>e.id===a);if(!s)return null;let{start:l,end:n}=E(s),i=t().completions.filter(e=>e.habitId===a&&e.timestamp>=l&&e.timestamp<n).sort((e,t)=>t.timestamp-e.timestamp);if(0===i.length)return null;let r=i[0];try{return await T(r.id),e(e=>({completions:e.completions.filter(e=>e.id!==r.id),persistenceError:null})),r}catch(t){return e({persistenceError:"Failed to undo completion."}),null}},async listCompletions(t){try{return await k(t)}catch(t){return e({persistenceError:"Failed to load completions."}),[]}}}));function F(e,t){let a=new Map;for(let s of t){let t=A(e,s.timestamp),l=a.get(t)||[];l.push(s),a.set(t,l)}return a}function W(e,t){return((null==t?void 0:t.length)||0)>=e.frequency}function z(e,t){let{start:a,end:s}=E(e),l=Math.min(t.filter(e=>e.timestamp>=a&&e.timestamp<s).length,e.frequency),n=Math.min(1,l/e.frequency);return{value:l,required:e.frequency,ratio:n}}function I(e,t){let a=q(e),s=F(e,t),l=0;for(let t=a;t>=0&&W(e,s.get(t));t--)l+=1;let n=0,i=0;for(let t=0;t<=a;t++)W(e,s.get(t))?(i+=1)>n&&(n=i):i=0;return{currentStreak:l,bestStreak:n}}function U(){let{habits:e,completions:t,rehydrate:a,persistenceError:i}=L(),[r,c]=(0,j.useState)(!0),[o,d]=(0,j.useState)(7),[m,g]=(0,j.useState)(""),[y,v]=(0,j.useState)("all"),N=(0,l.s0)(),[w,k]=(0,j.useState)("");(0,j.useEffect)(()=>{let e=!0;return Promise.resolve(a()).finally(()=>{e&&c(!1)}),()=>{e=!1}},[a]);let C=new Date,T=(0,u.b)(C).getTime(),D=(0,x.E)((0,u.b)(C),1-o).getTime(),S=(0,x.E)((0,u.b)(C),1).getTime();(0,j.useEffect)(()=>{k("Stats updated for last ".concat(o," days"))},[o]);let E=(0,j.useCallback)((e,t)=>{let a=(0,u.b)(new Date(M(e)));if("daily"===e.periodType){let e=(0,x.E)(a,t),s=(0,x.E)(a,t+1);return{start:e.getTime(),end:s.getTime()}}if("monthly"===e.periodType){let e=(0,h.z)((0,p.N)(a),t),s=(0,h.z)((0,p.N)(a),t+1);return{start:e.getTime(),end:s.getTime()}}let s=(0,x.E)(a,7*t),l=(0,x.E)(a,(t+1)*7);return{start:s.getTime(),end:l.getTime()}},[]),q=(0,j.useCallback)((e,t)=>{let a=A(e,D),s=A(e,S-1),l=0,n=0;for(let i=a;i<=s;i++){let a=E(e,i);a.end<=D||a.start>=S||(l+=e.frequency,n+=Math.min(t.filter(e=>e.timestamp>=a.start&&e.timestamp<a.end).length,e.frequency))}return{scheduled:l,completed:n}},[D,S,E]),F=(0,j.useCallback)((e,t)=>{let a=A(e,D),s=A(e,S-1),l=0;for(let n=a;n<=s;n++){let a=E(e,n);if(a.end<=D||a.start>=S)continue;let s=(0,u.b)(new Date(e.startDate?e.startDate:e.createdAt)).getTime();if(a.end<=s||a.end>Date.now())continue;let i=Math.min(t.filter(e=>e.timestamp>=a.start&&e.timestamp<a.end).length,e.frequency);l+=Math.max(0,e.frequency-i)}return l},[D,S,E]),W=(0,j.useMemo)(()=>(0,b.D)({start:new Date(D),end:new Date(T)}),[D,T]),z=(0,j.useMemo)(()=>t.filter(e=>e.timestamp>=D&&e.timestamp<S),[t,D,S]),U=(0,j.useMemo)(()=>{let e=new Map;for(let a of t){let t=(0,u.b)(new Date(a.timestamp)).getTime();e.set(t,(e.get(t)||0)+1)}return e},[t]),O=(0,j.useMemo)(()=>{let a=0,s=0;for(let l of e){let e=t.filter(e=>e.habitId===l.id),{completed:n}=q(l,e);a+=n,s+=F(l,e)}let l=z.length,n=s,i=a+n;return{totalCompletions:l,misses:n,completionRate:i>0?a/i:0}},[e,t,z,F,q]),P=(0,j.useMemo)(()=>{if(0===e.length)return{current:0,longest:0};let t=Math.min(...e.map(e=>e.startDate||T)),a=(0,b.D)({start:new Date((0,u.b)(new Date(t)).getTime()),end:new Date(T)}),s=0,l=0,n=0;for(let e of a){let t=(0,u.b)(e).getTime();(U.get(t)||0)>0?(n+=1)>l&&(l=n):n=0}for(let e=a.length-1;e>=0;e--){let t=(0,u.b)(a[e]).getTime();if((U.get(t)||0)>0)s+=1;else break}return{current:s,longest:l}},[e,U,T]),H=(0,j.useMemo)(()=>{let t=m.trim().toLowerCase(),a=t?e.filter(e=>e.name.toLowerCase().includes(t)):e;return"all"===y?a:a.filter(e=>e.periodType===y)},[e,m,y]);function B(){return(0,s.jsx)("button",{onClick:()=>{c(!0),Promise.resolve(a()).finally(()=>c(!1))},className:"btn btn-secondary",children:"Retry"})}function R(e){let{label:t,value:a,alt:l}=e;return(0,s.jsxs)("div",{className:"p-3 card","aria-busy":r,"aria-live":"polite",children:[(0,s.jsx)("div",{className:"text-sm text-slate-500",children:t}),(0,s.jsx)("div",{className:"text-2xl font-semibold","aria-label":l||t,children:a})]})}return(0,s.jsxs)("div",{className:"p-6",role:"main","aria-labelledby":"page-title",children:[(0,s.jsx)("div",{"aria-live":"polite",className:"sr-only",children:w}),(0,s.jsxs)("div",{className:"flex flex-col gap-3 mb-6 md:flex-row md:items-center md:justify-between",children:[(0,s.jsx)("h1",{id:"page-title",className:"text-2xl font-bold",children:"Dashboard"}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",role:"group","aria-label":"Date range",children:[(0,s.jsx)("button",{className:"btn ".concat(7===o?"btn-primary":"btn-secondary"),"aria-pressed":7===o,onClick:()=>d(7),children:"7 days"}),(0,s.jsx)("button",{className:"btn ".concat(30===o?"btn-primary":"btn-secondary"),"aria-pressed":30===o,onClick:()=>d(30),children:"30 days"})]})]}),i?(0,s.jsx)("div",{className:"p-3 mb-4 text-amber-700 bg-amber-50 rounded border border-amber-400",role:"alert",children:i}):null,r?(0,s.jsx)("section",{className:"grid grid-cols-1 gap-3 mb-6 text-sm md:grid-cols-3 lg:grid-cols-5",children:Array.from({length:5}).map((e,t)=>(0,s.jsx)("div",{className:"p-3 h-20 animate-pulse card"},t))}):(0,s.jsxs)("section",{className:"grid grid-cols-1 gap-3 mb-6 text-sm md:grid-cols-3 lg:grid-cols-5",children:[(0,s.jsx)(R,{label:"Current Streak",value:P.current}),(0,s.jsx)(R,{label:"Longest Streak",value:P.longest}),(0,s.jsx)(R,{label:"Completion Rate",value:"".concat(Math.round(100*O.completionRate),"%")}),(0,s.jsx)(R,{label:"Total Completions",value:O.totalCompletions}),(0,s.jsx)(R,{label:"Misses",value:O.misses})]}),(0,s.jsxs)("section",{className:"grid grid-cols-1 gap-4 mb-6 lg:grid-cols-2",children:[r?(0,s.jsx)("div",{className:"p-4 h-60 animate-pulse card"}):(0,s.jsx)(function(){if(i)return(0,s.jsxs)("div",{className:"p-4 card",role:"region","aria-label":"Completions trend",children:[(0,s.jsx)("div",{className:"mb-2 text-sm text-red-700",children:"Failed to load data."}),(0,s.jsx)(B,{})]});let e=W.map(e=>U.get((0,u.b)(e).getTime())||0);if(0===e.reduce((e,t)=>e+t,0))return(0,s.jsxs)("div",{className:"p-4 card",role:"region","aria-label":"Completions trend",children:[(0,s.jsx)("div",{className:"mb-3 text-sm font-medium",children:"Daily completions (trend)"}),(0,s.jsx)("div",{className:"text-sm text-slate-600",children:"No completions in this range."})]});let t=Math.max(1,...e),a=e.length>1?360/(e.length-1):0,l=e.map((e,s)=>[Math.round(s*a),Math.round(120-e/t*120)]).map((e,t)=>{let[a,s]=e;return"".concat(0===t?"M":"L"," ").concat(a," ").concat(s)}).join(" "),n="".concat(l," L ").concat(360," ").concat(120," L 0 ").concat(120," Z");return(0,s.jsxs)("div",{className:"p-4 card",role:"region","aria-label":"Completions trend",children:[(0,s.jsx)("div",{className:"mb-3 text-sm font-medium",children:"Daily completions (trend)"}),(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("svg",{viewBox:"0 0 ".concat(360," ").concat(120),role:"img","aria-label":"Line chart of daily completions",className:"w-full h-40",children:[(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"trendFill",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"0%",stopColor:"#475569",stopOpacity:"0.25"}),(0,s.jsx)("stop",{offset:"100%",stopColor:"#475569",stopOpacity:"0.05"})]})}),(0,s.jsx)("path",{d:n,fill:"url(#trendFill)"}),(0,s.jsx)("path",{d:l,fill:"none",stroke:"#334155",strokeWidth:"2"})]})})]})},{}),r?(0,s.jsx)("div",{className:"p-4 h-60 animate-pulse card"}):(0,s.jsx)(function(){if(i)return(0,s.jsxs)("div",{className:"p-4 card",role:"region","aria-label":"Completions by weekday",children:[(0,s.jsx)("div",{className:"mb-2 text-sm text-red-700",children:"Failed to load data."}),(0,s.jsx)(B,{})]});let e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=["#f59e0b","#10b981","#3b82f6","#8b5cf6","#ef4444","#14b8a6","#f97316"],a=[0,0,0,0,0,0,0];for(let e of W){let t=(0,u.b)(e).getTime(),s=(0,f.w)(e);a[s]+=U.get(t)||0}let l=a.reduce((e,t)=>e+t,0);if(0===l)return(0,s.jsxs)("div",{className:"p-4 card",role:"region","aria-label":"Completions by weekday",children:[(0,s.jsx)("div",{className:"mb-3 text-sm font-medium",children:"Completions by weekday"}),(0,s.jsx)("div",{className:"text-sm text-slate-600",children:"No data to show for this range."})]});let n=2*Math.PI*52,r=0;return(0,s.jsxs)("div",{className:"p-4 card",role:"region","aria-label":"Completions by weekday",children:[(0,s.jsx)("div",{className:"mb-3 text-sm font-medium",children:"Completions by weekday"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("svg",{viewBox:"0 0 140 140",className:"w-40 h-40",role:"img","aria-label":"Donut chart of completions by weekday",children:[(0,s.jsx)("circle",{cx:"70",cy:"70",r:52,fill:"none",stroke:"#e5e7eb",strokeWidth:"18"}),a.map((e,a)=>{if(0===e)return null;let i=e/l*n,c=(0,s.jsx)("circle",{cx:"70",cy:"70",r:52,fill:"none",stroke:t[a],strokeWidth:"18",strokeDasharray:"".concat(i," ").concat(n-i),strokeDashoffset:-r,transform:"rotate(-90 70 70)"},a);return r+=i,c}),(0,s.jsx)("text",{x:"70",y:"70",textAnchor:"middle",dominantBaseline:"central",className:"fill-slate-700",fontSize:"14",children:l})]}),(0,s.jsx)("ul",{className:"text-sm space-y-1",children:a.map((a,n)=>(0,s.jsxs)("li",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"inline-block w-3 h-3 rounded",style:{backgroundColor:t[n]}}),(0,s.jsx)("span",{className:"text-slate-700 w-8",children:e[n]}),(0,s.jsxs)("span",{className:"text-slate-500",children:[a," (",Math.round(a/l*100),"%)"]})]},n))})]})]})},{})]}),(0,s.jsxs)("section",{className:"flex gap-2 justify-between items-center mb-3",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Per-habit breakdown"}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsxs)("select",{value:y,onChange:e=>v(e.target.value),className:"rounded border border-slate-300 bg-[#f7f1e4] px-2 py-1.5 text-sm focus:border-slate-400 focus:outline-none","aria-label":"Filter by period",children:[(0,s.jsx)("option",{value:"all",children:"All periods"}),(0,s.jsx)("option",{value:"daily",children:"Daily"}),(0,s.jsx)("option",{value:"weekly",children:"Weekly"}),(0,s.jsx)("option",{value:"monthly",children:"Monthly"})]}),(0,s.jsx)("input",{type:"search",placeholder:"Search habits…",value:m,onChange:e=>g(e.target.value),className:"rounded border border-slate-300 bg-[#f7f1e4] px-3 py-1.5 text-sm focus:border-slate-400 focus:outline-none","aria-label":"Search habits"})]})]}),r?(0,s.jsx)("div",{className:"p-6 h-60 animate-pulse card"}):(0,s.jsx)(function(){if(0===e.length)return(0,s.jsxs)("div",{className:"p-6 text-center card",children:[(0,s.jsx)("div",{className:"mb-2 text-lg font-semibold",children:"No habits yet"}),(0,s.jsx)("p",{className:"mb-4 text-sm text-slate-600",children:"Create your first habit to start tracking progress."}),(0,s.jsxs)(n.rU,{to:"/habits",className:"btn btn-primary",children:[(0,s.jsx)("span",{className:"text-white align-middle material-icons",children:"add"}),(0,s.jsx)("span",{className:"ml-1 align-middle",children:"Create Habit"})]})]});if(i)return(0,s.jsxs)("div",{className:"p-4 card",children:[(0,s.jsx)("div",{className:"mb-2 text-sm text-red-700",children:"Failed to load habits."}),(0,s.jsx)(B,{})]});let a=H.map(e=>{let a=t.filter(t=>t.habitId===e.id),{currentStreak:s,bestStreak:l}=I(e,a),{completed:n}=q(e,a),i=F(e,a),r=n+i;return{habit:e,currentStreak:s,bestStreak:l,rate:r>0?Math.round(n/r*100):0,misses:i}});return(0,s.jsx)("div",{className:"overflow-x-auto p-0 card",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"text-left text-slate-600",children:[(0,s.jsx)("th",{className:"px-3 py-2",children:"Habit"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"Current Streak"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"Longest Streak"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"Completion Rate"}),(0,s.jsx)("th",{className:"px-3 py-2",children:"Misses"}),(0,s.jsx)("th",{className:"px-3 py-2"})]})}),(0,s.jsx)("tbody",{children:a.map(e=>{let{habit:t,currentStreak:a,bestStreak:l,rate:i,misses:r}=e;return(0,s.jsxs)("tr",{className:"border-t cursor-pointer border-slate-200 hover:bg-stone-100 focus-within:bg-stone-100",onClick:()=>N("/habit/".concat(t.id)),tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&N("/habit/".concat(t.id))},"aria-label":"View ".concat(t.name),children:[(0,s.jsx)("td",{className:"px-3 py-2",children:(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)("span",{className:"material-icons text-slate-700",children:t.icon}),(0,s.jsx)("div",{className:"font-medium",children:t.name})]})}),(0,s.jsx)("td",{className:"px-3 py-2",children:a}),(0,s.jsx)("td",{className:"px-3 py-2",children:l}),(0,s.jsxs)("td",{className:"px-3 py-2",children:[i,"%"]}),(0,s.jsx)("td",{className:"px-3 py-2",children:r}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:(0,s.jsx)(n.rU,{to:"/habit/".concat(t.id),className:"btn btn-secondary",onClick:e=>e.stopPropagation(),children:"View"})})]},t.id)})})]})})},{})]})}var O=a(8067),P=a(304),H=a(7436);function B(e){let{value:t,max:a,variant:l="bar",size:n=120,stroke:i=10,label:r}=e,c=Math.max(0,Math.min(1,(t||0)/(a||1)));if("circle"===l){let e=(n-i)/2,l=2*Math.PI*e,o=l*c;return(0,s.jsxs)("div",{role:"progressbar","aria-label":r||"Progress","aria-valuemin":0,"aria-valuemax":a,"aria-valuenow":t,"aria-valuetext":"".concat(null!=t?t:0," of ").concat(null!=a?a:0),className:"inline-flex items-center justify-center",style:{width:n,height:n},children:[(0,s.jsxs)("svg",{width:n,height:n,viewBox:"0 0 ".concat(n," ").concat(n),children:[(0,s.jsx)("circle",{cx:n/2,cy:n/2,r:e,fill:"none",strokeWidth:i,className:"text-slate-200 dark:text-slate-700",stroke:"currentColor"}),(0,s.jsx)("circle",{cx:n/2,cy:n/2,r:e,fill:"none",strokeWidth:i,strokeLinecap:"round",className:"text-green-500",strokeDasharray:"".concat(o," ").concat(l-o),transform:"rotate(-90 ".concat(n/2," ").concat(n/2,")"),stroke:"currentColor"})]}),(0,s.jsxs)("div",{className:"absolute text-center",children:[(0,s.jsxs)("div",{className:"text-xl font-semibold",children:[null!=t?t:0,"/",null!=a?a:0]}),r?(0,s.jsx)("div",{className:"text-xs text-slate-500",children:r}):null]})]})}return(0,s.jsx)("div",{className:"overflow-hidden w-full h-2 rounded bg-slate-200 dark:bg-slate-700",role:"progressbar","aria-label":r||"Progress","aria-valuemin":0,"aria-valuemax":a,"aria-valuenow":t,"aria-valuetext":"".concat(null!=t?t:0," of ").concat(null!=a?a:0),children:(0,s.jsx)("div",{className:"h-full bg-green-500",style:{width:"".concat(100*c,"%")}})})}function R(){var e;let{id:t}=(0,l.UO)(),{habits:a,completions:i,addCompletion:r,undoLastCompletion:c}=L(),o=a.find(e=>e.id===t),d=i.filter(e=>e.habitId===t),[m,x]=(0,j.useState)("30"),h=(0,j.useMemo)(()=>{if(!o)return null;let e=z(o,d),{currentStreak:t,bestStreak:a}=I(o,d);return{progress:e,currentStreak:t,bestStreak:a,failCount:function(e,t){let a=q(e),s=F(e,t),l=0;for(let t=0;t<a;t++)W(e,s.get(t))||(l+=1);return l}(o,d),record:function(e,t){let a=F(e,t),s=0;for(let e of a.values())e.length>s&&(s=e.length);return s}(o,d)}},[o,d]);if(!o)return(0,s.jsxs)("div",{className:"mx-auto max-w-3xl p-4",children:[(0,s.jsx)(n.rU,{to:"/",className:"text-sm hover:underline",children:"← Back"}),(0,s.jsx)("div",{className:"mt-4",children:"Habit not found."})]});let p=((null==h?void 0:h.progress.value)||0)>=(o.frequency||1),b="weekly"===o.periodType?"This week":"monthly"===o.periodType?"This month":"Today",f=function(e){let t=Math.max(0,Math.floor(e/1e3)),a=Math.floor(t/60),s=Math.floor(a/60),l=Math.floor(s/24);return l>=1?"".concat(l,"d"):s>=1?"".concat(s,"h"):a>=1?"".concat(a,"m"):"".concat(t,"s")}(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),{end:a}=E(e,t);return Math.max(0,a-t)}(o)),g="weekly"===(e=o.periodType)?"Weekly":"monthly"===e?"Monthly":"Daily",y="weekly"===o.periodType?"week":"monthly"===o.periodType?"month":"day";async function v(){await c(o.id)}let N=d.slice().sort((e,t)=>t.timestamp-e.timestamp).find(e=>{let t=(0,u.b)(new Date).getTime();return e.timestamp>=t&&e.timestamp<t+864e5}),w=d.slice().sort((e,t)=>t.timestamp-e.timestamp),k="all"===m?0:Date.now()-864e5*Number(m),C=w.filter(e=>e.timestamp>=k),T=new Map;for(let e of C){let t=(0,u.b)(new Date(e.timestamp)).getTime(),a=T.get(t)||[];a.push(e),T.set(t,a)}let D=Array.from(T.entries()).sort((e,t)=>t[0]-e[0]);return(0,s.jsxs)("div",{className:"mx-auto max-w-4xl p-6",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(n.rU,{to:"/",className:"hover:underline",children:"Habits"}),(0,s.jsx)("span",{className:"text-slate-400",children:"›"}),(0,s.jsx)("span",{className:"text-slate-600",children:o.name})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"material-icons text-slate-700",children:o.icon}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:o.name})]}),(0,s.jsxs)("div",{className:"hidden md:flex items-center gap-2 ml-3",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded-full bg-slate-100 text-slate-600 text-xs",children:g}),(0,s.jsxs)("span",{className:"px-2 py-1 rounded-full bg-slate-100 text-slate-600 text-xs",children:["Target ",o.frequency,"/",y]})]}),(0,s.jsx)("div",{className:"ml-4",children:p?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"px-3 py-2 rounded bg-green-50 text-green-700 text-sm",children:["Done ",b.toLowerCase()]}),N?(0,s.jsx)("button",{onClick:v,className:"text-sm text-slate-600 hover:underline",children:"Undo"}):null]}):(0,s.jsx)("button",{onClick:function(){r(o.id)},className:"btn btn-primary",children:"Mark done"})})]})]}),(0,s.jsxs)("div",{className:"mb-8 grid grid-cols-1 gap-6 md:grid-cols-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-center md:col-span-1",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(B,{value:(null==h?void 0:h.progress.value)||0,max:o.frequency,variant:"circle",size:160,stroke:12,label:b}),(0,s.jsxs)("div",{className:"mt-2 text-center text-xs text-slate-500",children:["Resets in ",f]})]})}),(0,s.jsxs)("div",{className:"md:col-span-2 grid grid-cols-2 gap-3 text-sm sm:grid-cols-3",children:[(0,s.jsxs)("div",{className:"rounded border p-3",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Streak"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:(null==h?void 0:h.currentStreak)||0})]}),(0,s.jsxs)("div",{className:"rounded border p-3",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Best streak"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:(null==h?void 0:h.bestStreak)||0})]}),(0,s.jsxs)("div",{className:"rounded border p-3",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Missed"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:(null==h?void 0:h.failCount)||0})]})]})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Activity"}),(0,s.jsx)("div",{className:"flex gap-1 text-xs",children:["7","30","all"].map(e=>(0,s.jsx)("button",{onClick:()=>x(e),className:"px-2 py-1 rounded ".concat(m===e?"bg-slate-900 text-white":"bg-slate-100 text-slate-600"),children:"all"===e?"All":"".concat(e,"d")},e))})]}),0===D.length?(0,s.jsx)("div",{className:"text-sm text-slate-600",children:"No activity in this range."}):(0,s.jsx)("div",{className:"space-y-4",children:D.map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-2 text-sm font-medium text-slate-700",children:function(e){let t=new Date(e);return(0,O.z)(t)?"Today":(0,P.g)(t)?"Yesterday":(0,H.WU)(t,"MMM d, yyyy")}(t)}),(0,s.jsx)("ul",{className:"space-y-2 text-sm",children:a.map((e,a)=>(0,s.jsxs)("li",{className:"flex items-center justify-between rounded border p-2 dark:border-slate-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{children:(0,H.WU)(new Date(e.timestamp),"p")}),(0,s.jsx)("span",{className:"text-slate-500",children:function(e){let t=A(o,e);return"weekly"===o.periodType?"Week ".concat(t+1):"monthly"===o.periodType?"Month ".concat(t+1):"Day ".concat(t+1)}(e.timestamp)})]}),0===a&&(0,O.z)(new Date(t))?(0,s.jsx)("button",{onClick:v,className:"text-xs text-slate-600 hover:underline",children:"Undo"}):null]},e.id))})]},t)})})]})]})}function _(e){let{isOpen:t,onClose:a,title:l,children:n,footer:i}=e,r=(0,j.useRef)(null),c=(0,j.useRef)(null);return((0,j.useEffect)(()=>{if(t){c.current=document.activeElement,setTimeout(()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.focus()},0);let e=e=>{"Escape"===e.key&&(null==a||a())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}},[t,a]),(0,j.useEffect)(()=>{!t&&c.current&&c.current.focus()},[t]),t)?(0,s.jsx)("div",{className:"flex fixed inset-0 z-50 justify-center items-center backdrop-blur-sm bg-black/20",role:"dialog","aria-modal":"true",children:(0,s.jsxs)("div",{ref:r,tabIndex:-1,className:"mx-4 w-full max-w-xl rounded-xl border border-slate-200 bg-[#f6f0e3] p-6 shadow-xl outline-none",role:"document","aria-labelledby":"modal-title",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsx)("h2",{id:"modal-title",className:"text-lg font-semibold",children:l}),(0,s.jsx)("button",{onClick:a,"aria-label":"Close",className:"material-icons text-slate-600 hover:text-slate-900",children:"close"})]}),(0,s.jsx)("div",{className:"mb-2",children:n}),i?(0,s.jsx)("div",{className:"flex gap-2 justify-end mt-4",children:i}):null]})}):null}let V=["check_circle","fitness_center","self_improvement","book","menu_book","water_drop","restaurant","directions_run","brush","music_note","bedtime"];function J(e){let{value:t,onChange:a}=e;return(0,s.jsx)("div",{className:"grid grid-cols-8 gap-2",children:V.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>null==a?void 0:a(e),className:"material-icons rounded border border-slate-300 bg-[#f7f1e4] p-2 text-slate-700 hover:bg-slate-100 ".concat(t===e?"ring-2 ring-slate-400":""),"aria-pressed":t===e,"aria-label":e,children:e},e))})}let Z=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"}];function K(e){let{initialValue:t,onSubmit:a,onCancel:l}=e,{habits:n}=L(),[i,r]=(0,j.useState)((null==t?void 0:t.name)||""),[c,o]=(0,j.useState)((null==t?void 0:t.description)||""),[d,m]=(0,j.useState)((null==t?void 0:t.periodType)||"daily"),[x,h]=(0,j.useState)((null==t?void 0:t.frequency)||1),[p,b]=(0,j.useState)((null==t?void 0:t.category)||""),[f,g]=(0,j.useState)((null==t?void 0:t.icon)||"check_circle"),[y,v]=(0,j.useState)({}),N=(0,j.useId)(),w="name-".concat(N),k="description-".concat(N),C="period-".concat(N),T="frequency-".concat(N),D="category-".concat(N),S="categories-".concat(N),M=Array.from(new Set((n||[]).map(e=>e.category).filter(Boolean))).sort((e,t)=>e.localeCompare(t));return(0,s.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),!function(){let e={};i.trim()||(e.name="Name is required");let t=Number(x);return(!Number.isInteger(t)||t<1)&&(e.frequency="Frequency must be an integer ≥ 1"),v(e),0===Object.keys(e).length}())return;let s=(0,u.b)(new Date).getTime(),l={...(null==t?void 0:t.id)?{id:t.id}:{},name:i.trim(),description:c.trim()||void 0,periodType:d,frequency:Number(x),category:p.trim()||void 0,icon:f,startDate:s};null==a||a(l)},className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:w,className:"block mb-1 text-sm font-medium",children:"Name"}),(0,s.jsx)("input",{id:w,name:"name",value:i,onChange:e=>r(e.target.value),className:"w-full rounded border border-slate-300 bg-[#f7f1e4] px-3 py-2 focus:border-slate-400 focus:outline-none","aria-invalid":!!y.name,"aria-describedby":y.name?"".concat(w,"-error"):void 0,required:!0}),y.name?(0,s.jsx)("p",{id:"".concat(w,"-error"),className:"mt-1 text-sm text-red-600",children:y.name}):null]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:k,className:"block mb-1 text-sm font-medium",children:"Description"}),(0,s.jsx)("textarea",{id:k,name:"description",value:c,onChange:e=>o(e.target.value),className:"w-full rounded border border-slate-300 bg-[#f7f1e4] px-3 py-2 focus:border-slate-400 focus:outline-none",rows:3})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:C,className:"block mb-1 text-sm font-medium",children:"Period"}),(0,s.jsx)("select",{id:C,name:"periodType",value:d,onChange:e=>m(e.target.value),className:"w-full rounded border border-slate-300 bg-[#f7f1e4] px-3 py-2 focus:border-slate-400 focus:outline-none",children:Z.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:T,className:"block mb-1 text-sm font-medium",children:"Frequency"}),(0,s.jsx)("input",{id:T,name:"frequency",type:"number",min:1,step:1,value:x,onChange:e=>h(e.target.value),className:"w-full rounded border border-slate-300 bg-[#f7f1e4] px-3 py-2 focus:border-slate-400 focus:outline-none","aria-invalid":!!y.frequency,"aria-describedby":y.frequency?"".concat(T,"-error"):void 0}),y.frequency?(0,s.jsx)("p",{id:"".concat(T,"-error"),className:"mt-1 text-sm text-red-600",children:y.frequency}):null]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:D,className:"block mb-1 text-sm font-medium",children:"Category"}),(0,s.jsx)("input",{id:D,name:"category",value:p,onChange:e=>b(e.target.value),className:"w-full rounded border border-slate-300 bg-[#f7f1e4] px-3 py-2 focus:border-slate-400 focus:outline-none",list:S,placeholder:M.length?"Type or choose…":"Type a category",autoComplete:"off"}),M.length?(0,s.jsx)("datalist",{id:S,children:M.map(e=>(0,s.jsx)("option",{value:e},e))}):null]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-2 text-sm font-medium",children:"Icon"}),(0,s.jsx)(J,{value:f,onChange:g})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)("button",{type:"button",onClick:l,className:"btn btn-secondary",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save"})]})]})}function Q(){let{habits:e,completions:t,addCompletion:a,undoLastCompletion:l,deleteHabit:i,updateHabit:r}=L(),[c,o]=(0,j.useState)(null),d=(0,j.useMemo)(()=>e.map(e=>{let r=t.filter(t=>t.habitId===e.id),c=z(e,r),d=c.value>=e.frequency,{start:m,end:u}=E(e),x=r.some(e=>e.timestamp>=m&&e.timestamp<u);return(0,s.jsxs)("div",{className:"p-4 card",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)("span",{className:"material-icons text-slate-700",children:e.icon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-base font-semibold",children:e.name}),(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e.category||"Uncategorized"})]}),(0,s.jsx)(n.rU,{to:"/habit/".concat(e.id),className:"ml-1 btn btn-secondary btn-icon","aria-label":"View stats",title:"View stats",children:(0,s.jsx)("span",{className:"material-icons",children:"insights"})})]}),(0,s.jsxs)("div",{className:"text-sm ".concat(d?"text-green-700":"text-slate-600"),children:[c.value,"/",e.frequency]})]}),(0,s.jsx)(B,{value:c.value,max:e.frequency}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,s.jsx)("button",{onClick:()=>a(e.id,Date.now()),disabled:d,className:"btn btn-primary btn-icon ".concat(d?"opacity-60":""),"aria-label":"Quick complete",title:"Quick complete",children:(0,s.jsx)("span",{className:"material-icons",children:"check_circle"})}),(0,s.jsx)("button",{onClick:()=>l(e.id),disabled:!x,className:"btn btn-secondary btn-icon","aria-label":"Undo last completion",title:"Undo last completion",children:(0,s.jsx)("span",{className:"material-icons",children:"undo"})})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,s.jsx)("button",{onClick:()=>o(e),className:"btn btn-secondary btn-icon","aria-label":"Edit habit",title:"Edit habit",children:(0,s.jsx)("span",{className:"material-icons",children:"edit"})}),(0,s.jsx)("button",{onClick:()=>{confirm("Delete habit and its completions?")&&i(e.id)},className:"btn btn-danger btn-icon","aria-label":"Delete habit",title:"Delete habit",children:(0,s.jsx)("span",{className:"material-icons",children:"delete"})})]})]})]},e.id)}),[e,t,a,l,i]);return(0,s.jsxs)("div",{className:"space-y-3",children:[d,(0,s.jsx)(_,{isOpen:!!c,onClose:()=>o(null),title:"Edit Habit",children:c?(0,s.jsx)(K,{initialValue:c,onSubmit:function(e){r(c.id,e),o(null)},onCancel:()=>o(null)}):null})]})}function Y(){let{habits:e,completions:t,rehydrate:a,createHabit:l,persistenceError:n}=L(),[i,r]=(0,j.useState)(!1);(0,j.useEffect)(()=>{a()},[a]);let c=(0,j.useMemo)(()=>({totalCompletions:t.length,totalHabits:e.length}),[e,t]);return(0,s.jsxs)("div",{className:"p-6",role:"main","aria-labelledby":"page-title",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsx)("h1",{id:"page-title",className:"text-2xl font-bold",children:"Habits"})}),n?(0,s.jsx)("div",{className:"p-3 mb-4 text-amber-700 bg-amber-50 rounded border border-amber-400",role:"alert",children:n}):null,(0,s.jsxs)("section",{className:"grid grid-cols-3 gap-3 mb-6 text-sm",children:[(0,s.jsxs)("div",{className:"p-3 card",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Total habits"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:c.totalHabits})]}),(0,s.jsxs)("div",{className:"p-3 card",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Total completions"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:c.totalCompletions})]}),(0,s.jsxs)("div",{className:"p-3 card",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Today"}),(0,s.jsx)("div",{className:"text-xl font-semibold",children:new Date().toLocaleDateString()})]})]}),(0,s.jsx)("div",{className:"flex justify-end mb-4",children:(0,s.jsxs)("button",{onClick:()=>r(!0),className:"btn btn-primary",children:[(0,s.jsx)("span",{className:"text-white align-middle material-icons",children:"add"}),(0,s.jsx)("span",{className:"ml-1 align-middle",children:"New Habit"})]})}),0===e.length?(0,s.jsxs)("div",{className:"p-6 text-center card",children:[(0,s.jsx)("div",{className:"mb-2 text-lg font-semibold",children:"No habits yet"}),(0,s.jsx)("p",{className:"mb-4 text-sm text-slate-600",children:"Create your first habit to start tracking progress."}),(0,s.jsxs)("button",{onClick:()=>r(!0),className:"btn btn-primary",children:[(0,s.jsx)("span",{className:"text-white align-middle material-icons",children:"add"}),(0,s.jsx)("span",{className:"ml-1 align-middle",children:"Create Habit"})]})]}):(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 xl:grid-cols-2",children:[(0,s.jsx)("div",{className:"space-y-3",children:(0,s.jsx)(Q,{})}),(0,s.jsx)("div",{className:"space-y-3",children:(0,s.jsxs)("div",{className:"p-4 card",children:[(0,s.jsx)("h2",{className:"mb-2 text-lg font-semibold",children:"Tips"}),(0,s.jsxs)("ul",{className:"pl-5 text-sm list-disc text-slate-700",children:[(0,s.jsx)("li",{children:"Use the plus button to add new habits."}),(0,s.jsx)("li",{children:"Click a habit name to view detailed stats."}),(0,s.jsx)("li",{children:"Undo removes the latest completion in the current period."})]})]})})]}),(0,s.jsx)(_,{isOpen:i,onClose:()=>r(!1),title:"Create Habit",children:(0,s.jsx)(K,{onSubmit:function(e){l(e)&&r(!1)},onCancel:()=>r(!1)})})]})}function G(){let{login:e,isLoading:t,error:a,isAuthenticated:n,clearError:i}=m(),r=(0,l.s0)();(0,j.useEffect)(()=>{n&&r("/habits")},[n,r]);let c=async()=>{i(),await e()};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#f8f3e7"},children:(0,s.jsxs)("div",{className:"max-w-md w-full space-y-8 p-8 card",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"mt-6 text-3xl font-extrabold text-slate-900",children:"Welcome to Habit Tracker"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-slate-600",children:"Sign in with your Microsoft account to get started"})]}),(0,s.jsxs)("div",{className:"mt-8",children:[a&&(0,s.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:a}),(0,s.jsxs)("button",{onClick:c,disabled:t,className:"group relative w-full flex justify-center py-3 px-4 btn btn-primary",children:[(0,s.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,s.jsxs)("svg",{className:"h-5 w-5 text-slate-300",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zm0 18C5.589 18 2 14.411 2 10S5.589 2 10 2s8 3.589 8 8-3.589 8-8 8z",clipRule:"evenodd"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M13.5 8.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 8.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z",clipRule:"evenodd"})]})}),t?"Signing in...":"Sign in with Microsoft"]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsxs)("div",{className:"text-xs text-slate-500",children:["By signing in, you agree to use this application for habit tracking purposes.",(0,s.jsx)("br",{}),"Your Microsoft account information will be used to create a secure profile."]})})]})]})})}function X(e){let{isActive:t}=e;return"flex items-center gap-2 rounded-lg px-3 py-1.5 text-sm ".concat(t?"bg-slate-200 text-slate-900":"hover:bg-slate-100 text-slate-800")}function $(){let[e,t]=(0,j.useState)(!1),[a,l]=(0,j.useState)(!1),{user:i,logout:r}=m(),c=async()=>{await r(),l(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"fixed right-4 bottom-4 z-40 p-3 text-white rounded-full shadow bg-slate-700 lg:hidden","aria-label":e?"Close menu":"Open menu","aria-expanded":e,"aria-controls":"primary-navigation",onClick:()=>t(e=>!e),children:(0,s.jsx)("span",{className:"material-icons",children:"menu"})}),(0,s.jsxs)("aside",{className:"bg-[#f6efdf] p-4 border-r lg:block ".concat(e?"fixed inset-y-0 left-0 z-30 w-64":"hidden"," lg:static lg:w-auto"),"aria-label":"Primary",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6 text-lg font-semibold text-slate-800",children:[(0,s.jsx)("span",{children:"Habit Tracker"}),(0,s.jsx)("button",{className:"btn btn-secondary btn-icon lg:hidden","aria-label":"Close",onClick:()=>t(!1),children:(0,s.jsx)("span",{className:"material-icons",children:"close"})})]}),(0,s.jsxs)("nav",{id:"primary-navigation",className:"flex flex-col gap-2 mb-6","aria-label":"Primary",children:[(0,s.jsxs)(n.OL,{to:"/habits",className:X,onClick:()=>t(!1),children:[(0,s.jsx)("span",{className:"text-base material-icons",children:"checklist"}),(0,s.jsx)("span",{children:"Habits"})]}),(0,s.jsxs)(n.OL,{to:"/dashboard",className:X,onClick:()=>t(!1),children:[(0,s.jsx)("span",{className:"text-base material-icons",children:"dashboard"}),(0,s.jsx)("span",{children:"Dashboard"})]})]}),i&&(0,s.jsxs)("div",{className:"border-t pt-4 mt-auto",children:[(0,s.jsx)("div",{className:"text-xs text-slate-600 mb-2",children:"Signed in as:"}),(0,s.jsx)("div",{className:"text-sm font-medium text-slate-800 mb-3 truncate",children:i.name||i.email}),(0,s.jsxs)("button",{onClick:()=>{l(!0)},className:"flex items-center gap-2 rounded-lg px-3 py-1.5 text-sm hover:bg-slate-100 text-slate-800 w-full",children:[(0,s.jsx)("span",{className:"text-base material-icons",children:"logout"}),(0,s.jsx)("span",{children:"Sign Out"})]})]})]}),(0,s.jsx)(_,{isOpen:a,onClose:()=>l(!1),title:"Confirm Sign Out",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"Are you sure you want to sign out?"}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)("button",{onClick:()=>l(!1),className:"btn btn-secondary",children:"Cancel"}),(0,s.jsx)("button",{onClick:c,className:"btn btn-danger",children:"Sign Out"})]})]})})]})}function ee(e){let{children:t}=e,{isAuthenticated:a,isLoading:n}=m();return n?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):a?t:(0,s.jsx)(l.Fg,{to:"/login",replace:!0})}function et(e){let{children:t}=e,{isAuthenticated:a,isLoading:n}=m();return n?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):a?(0,s.jsx)(l.Fg,{to:"/habits",replace:!0}):t}function ea(){return(0,s.jsxs)(n.VK,{children:[(0,s.jsx)("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:fixed focus:left-4 focus:top-4 focus:z-50 focus:rounded focus:bg-white focus:px-3 focus:py-2 focus:shadow",children:"Skip to content"}),(0,s.jsxs)(l.Z5,{children:[(0,s.jsx)(l.AW,{path:"/login",element:(0,s.jsx)(et,{children:(0,s.jsx)(G,{})})}),(0,s.jsx)(l.AW,{path:"/*",element:(0,s.jsx)(ee,{children:(0,s.jsxs)("div",{className:"mx-auto grid min-h-screen max-w-7xl grid-cols-1 lg:grid-cols-[260px_1fr]",children:[(0,s.jsx)($,{}),(0,s.jsx)("main",{id:"main-content",className:"min-h-screen",tabIndex:-1,children:(0,s.jsxs)(l.Z5,{children:[(0,s.jsx)(l.AW,{path:"/",element:(0,s.jsx)(l.Fg,{to:"/habits",replace:!0})}),(0,s.jsx)(l.AW,{path:"/habits",element:(0,s.jsx)(Y,{})}),(0,s.jsx)(l.AW,{path:"/dashboard",element:(0,s.jsx)(U,{})}),(0,s.jsx)(l.AW,{path:"/habit/:id",element:(0,s.jsx)(R,{})})]})})]})})})]})]})}}}]);